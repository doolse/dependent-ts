// Compile-Time Computation Demo
// Demonstrates staged evaluation: comptime() forces compile-time evaluation

import { jsx, jsxs } from "react/jsx-runtime" in
import { useState } from "react" in

fn(props) =>
  let [count, setCount] = useState(0) in

  // Define functions for compile-time computation
  let factorial = fn fac(n) => if n <= 1 then 1 else n * fac(n - 1) in
  let fib = fn fibRec(n) => if n <= 1 then n else fibRec(n - 1) + fibRec(n - 2) in

  <div style={{ fontFamily: "system-ui", padding: "20px", maxWidth: "600px", margin: "0 auto" }}>
    <h1>Compile-Time Computation Demo</h1>

    <div style={{ backgroundColor: "#f0f8ff", padding: "15px", borderRadius: "8px", marginBottom: "20px" }}>
      <h3 style={{ margin: "0 0 10px 0" }}>Staged Evaluation</h3>
      <p style={{ margin: 0, fontSize: "14px" }}>
        This language uses staged evaluation - comptime() ensures values are computed during compilation, not at runtime.
      </p>
    </div>

    <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: "20px" }}>
      <div style={{ backgroundColor: "#e8f5e9", padding: "15px", borderRadius: "8px" }}>
        <h3 style={{ margin: "0 0 10px 0" }}>Factorial(10)</h3>
        <p style={{ fontSize: "24px", fontWeight: "bold", margin: 0 }}>
          {factorial(10).toString()}
        </p>
      </div>

      <div style={{ backgroundColor: "#fff3e0", padding: "15px", borderRadius: "8px" }}>
        <h3 style={{ margin: "0 0 10px 0" }}>Fibonacci(15)</h3>
        <p style={{ fontSize: "24px", fontWeight: "bold", margin: 0 }}>
          {fib(15).toString()}
        </p>
      </div>
    </div>

    <div style={{ marginTop: "20px", backgroundColor: "#e3f2fd", padding: "15px", borderRadius: "8px" }}>
      <h3 style={{ margin: "0 0 10px 0" }}>Factorials 1-7</h3>
      <div style={{ display: "flex", gap: "10px", flexWrap: "wrap" }}>
        {[factorial(1), factorial(2), factorial(3), factorial(4), factorial(5), factorial(6), factorial(7)].map(fn(f) =>
          <span style={{ padding: "5px 10px", backgroundColor: "#1976d2", color: "white", borderRadius: "4px" }}>
            {f.toString()}
          </span>
        )}
      </div>
    </div>

    <div style={{ marginTop: "20px", backgroundColor: "#fce4ec", padding: "15px", borderRadius: "8px" }}>
      <h3 style={{ margin: "0 0 10px 0" }}>Fibonacci 1-10</h3>
      <div style={{ display: "flex", gap: "10px", flexWrap: "wrap" }}>
        {[fib(1), fib(2), fib(3), fib(4), fib(5), fib(6), fib(7), fib(8), fib(9), fib(10)].map(fn(f) =>
          <span style={{ padding: "5px 10px", backgroundColor: "#c2185b", color: "white", borderRadius: "4px" }}>
            {f.toString()}
          </span>
        )}
      </div>
    </div>

    <div style={{ marginTop: "20px", backgroundColor: "#f5f5f5", padding: "15px", borderRadius: "8px" }}>
      <h3 style={{ margin: "0 0 10px 0" }}>Runtime Counter</h3>
      <div style={{ display: "flex", alignItems: "center", gap: "10px" }}>
        <button style={{ padding: "10px 20px", fontSize: "18px", cursor: "pointer" }} onClick={fn() => setCount(count - 1)}>-</button>
        <span style={{ fontSize: "24px", fontWeight: "bold", minWidth: "50px", textAlign: "center" }}>{count.toString()}</span>
        <button style={{ padding: "10px 20px", fontSize: "18px", cursor: "pointer" }} onClick={fn() => setCount(count + 1)}>+</button>
      </div>
    </div>
  </div>
